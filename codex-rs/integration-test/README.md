# Codex Web ä¸ TUI é›†æˆå…¼å®¹æ€§æœ€å°éªŒè¯å®éªŒ

## æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªä¸“é—¨ä¸ºéªŒè¯ Codex Web ä¸ç°æœ‰ codex-rs TUI ç³»ç»Ÿè¿›ç¨‹å†…é›†æˆå…¼å®¹æ€§è€Œè®¾è®¡çš„æœ€å°éªŒè¯å®éªŒã€‚é€šè¿‡é‡åŒ–æµ‹è¯•å…³é”®é›†æˆç‚¹ï¼Œç¡®ä¿ Web ç«¯èƒ½å¤Ÿå®‰å…¨å¤ç”¨ç°æœ‰æ ¸å¿ƒèƒ½åŠ›ï¼Œè€Œä¸ç ´å TUI ç³»ç»Ÿçš„ç¨³å®šæ€§ã€‚

## æ ¸å¿ƒä¸ç¡®å®šæ€§åˆ†æ

### ä¸»è¦é£é™©ç‚¹
1. **ConversationManager çŠ¶æ€å†²çª**: å¤šä¸ª UI ç•Œé¢åŒæ—¶è®¿é—®å¯èƒ½å¯¼è‡´çŠ¶æ€ä¸ä¸€è‡´
2. **é…ç½®æ–‡ä»¶ç«äº‰**: TUI å’Œ Web åŒæ—¶ä¿®æ”¹é…ç½®å¯èƒ½å¯¼è‡´æ•°æ®è…åŒ–
3. **æ²™ç®±ç¯å¢ƒæ±¡æŸ“**: Web ç»„ä»¶å¯èƒ½æ„å¤–ä¿®æ”¹å…³é”®æ²™ç®±ç¯å¢ƒå˜é‡
4. **èµ„æºç«äº‰**: ç«¯å£ã€æ–‡ä»¶é”ã€å†…å­˜ç­‰èµ„æºçš„å¹¶å‘è®¿é—®å†²çª
5. **è¿›ç¨‹ç”Ÿå‘½å‘¨æœŸç®¡ç†**: TUI å’Œ Web çš„å¯åŠ¨/å…³é—­é¡ºåºå’Œæ¸…ç†æœºåˆ¶

### é«˜å½±å“åœºæ™¯
- ä¸€æ—¦ç ´åç°æœ‰ TUI ç³»ç»Ÿï¼Œç”¨æˆ·å°†æ— æ³•æ­£å¸¸ä½¿ç”¨ Codex
- æ²™ç®±ç­–ç•¥è¢«ç ´åå¯èƒ½å¯¼è‡´å®‰å…¨æ¼æ´
- é…ç½®æŸåä¼šå½±å“æ‰€æœ‰ Codex åŠŸèƒ½

## å®éªŒæ¶æ„

### æµ‹è¯•ç»„ä»¶

```
codex-rs/integration-test/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ lib.rs                      # ä¸»é›†æˆæµ‹è¯•åè°ƒå™¨
â”‚   â”œâ”€â”€ main.rs                     # å¯æ‰§è¡Œæµ‹è¯•å…¥å£
â”‚   â”œâ”€â”€ conversation_manager_test.rs # ConversationManager æµ‹è¯•
â”‚   â”œâ”€â”€ config_isolation_test.rs     # é…ç½®éš”ç¦»æµ‹è¯•
â”‚   â”œâ”€â”€ sandbox_protection_test.rs   # æ²™ç®±ä¿æŠ¤æµ‹è¯•
â”‚   â””â”€â”€ concurrent_run_test.rs       # å¹¶å‘è¿è¡Œæµ‹è¯•
â”œâ”€â”€ Cargo.toml                      # é¡¹ç›®é…ç½®
â””â”€â”€ README.md                       # æœ¬æ–‡æ¡£
```

### éªŒè¯æµç¨‹

```mermaid
graph TD
    A[å¼€å§‹éªŒè¯] --> B[ConversationManager æµ‹è¯•]
    B --> C[é…ç½®éš”ç¦»æµ‹è¯•]
    C --> D[æ²™ç®±ä¿æŠ¤æµ‹è¯•]
    D --> E[å¹¶å‘è¿è¡Œæµ‹è¯•]
    E --> F[ç”Ÿæˆè¯„ä¼°æŠ¥å‘Š]
    F --> G[ç¡®å®šé›†æˆç­–ç•¥]
    
    B --> B1[çº¿ç¨‹å®‰å…¨æ€§]
    B --> B2[å†…å­˜ç®¡ç†]
    B --> B3[çŠ¶æ€éš”ç¦»]
    
    C --> C1[åŠ è½½éš”ç¦»]
    C --> C2[å¹¶å‘è®¿é—®]
    C --> C3[æ–‡ä»¶é”å®š]
    
    D --> D1[ç¯å¢ƒå˜é‡ä¿æŠ¤]
    D --> D2[éš”ç¦»å®Œæ•´æ€§]
    D --> D3[æ¢å¤æœºåˆ¶]
    
    E --> E1[èµ„æºå†²çªæ£€æµ‹]
    E --> E2[æ€§èƒ½å½±å“]
    E --> E3[æ¸…ç†æœºåˆ¶]
```

## å¿«é€Ÿå¼€å§‹

### 1. è¿è¡Œå®Œæ•´éªŒè¯

```bash
# åœ¨ codex-rs ç›®å½•ä¸‹
cd integration-test

# æ‰§è¡Œå®Œæ•´é›†æˆéªŒè¯
cargo run --bin run-integration-test

# æˆ–è€…è¿è¡Œæµ‹è¯•å¥—ä»¶
cargo test

# å¯ç”¨è¯¦ç»†æ—¥å¿—
RUST_LOG=debug cargo run --bin run-integration-test
```

### 2. æŸ¥çœ‹éªŒè¯ç»“æœ

éªŒè¯å®Œæˆåä¼šç”Ÿæˆä¸¤ä¸ªæŠ¥å‘Šæ–‡ä»¶ï¼š

```bash
# JSON æ ¼å¼æŠ¥å‘Šï¼ˆç¨‹åºåŒ–å¤„ç†ï¼‰
cat integration_validation_report.json

# Markdown æ ¼å¼æŠ¥å‘Šï¼ˆäººç±»å¯è¯»ï¼‰
cat integration_validation_report.md
```

### 3. ç†è§£éªŒè¯ç»“æœ

æŠ¥å‘ŠåŒ…å«ä»¥ä¸‹å…³é”®ä¿¡æ¯ï¼š

- **æ‰§è¡Œæ‘˜è¦**: æµ‹è¯•é€šè¿‡ç‡ã€æ‰§è¡Œæ—¶é—´ã€æ•´ä½“å¯è¡Œæ€§
- **è¯¦ç»†æµ‹è¯•ç»“æœ**: æ¯ä¸ªæµ‹è¯•ç»„ä»¶çš„å…·ä½“è¡¨ç°
- **é£é™©è¯„ä¼°**: é£é™©ç­‰çº§å’Œä¸»è¦å…³æ³¨ç‚¹
- **é›†æˆç­–ç•¥å»ºè®®**: åŸºäºæµ‹è¯•ç»“æœçš„å…·ä½“å»ºè®®
- **é‡åŒ–æŒ‡æ ‡è¡¨**: å¯¹ç…§æˆåŠŸæ ‡å‡†çš„è¯¦ç»†è¯„ä¼°

## æµ‹è¯•é‡ç‚¹è¯´æ˜

### 1. ConversationManager è¿›ç¨‹å†…å¤ç”¨å®‰å…¨æ€§

**æµ‹è¯•å†…å®¹**ï¼š
- å¹¶å‘åˆ›å»ºå¯¹è¯çš„çº¿ç¨‹å®‰å…¨æ€§
- å†…å­˜æ³„æ¼æ£€æµ‹
- çŠ¶æ€éš”ç¦»éªŒè¯

**æˆåŠŸæ ‡å‡†**ï¼š
- çº¿ç¨‹å®‰å…¨æ€§éªŒè¯é€šè¿‡
- æ— å†…å­˜æ³„æ¼
- å¯¹è¯çŠ¶æ€å®Œå…¨éš”ç¦»

### 2. é…ç½®æ–‡ä»¶å…±äº«å’Œéš”ç¦»ç­–ç•¥

**æµ‹è¯•å†…å®¹**ï¼š
- ç‹¬ç«‹é…ç½®åŠ è½½éš”ç¦»
- å¹¶å‘é…ç½®è®¿é—®å®‰å…¨æ€§
- æ–‡ä»¶é”å†²çªæ£€æµ‹
- ç¯å¢ƒå˜é‡è¦†ç›–éš”ç¦»

**æˆåŠŸæ ‡å‡†**ï¼š
- TUI å’Œ Web é…ç½®åŠ è½½äº’ä¸å¹²æ‰°
- å…±äº«é…ç½®ä¿æŒä¸€è‡´æ€§
- æ— é…ç½®æ–‡ä»¶è…åŒ–

### 3. æ²™ç®±ç¯å¢ƒå˜é‡å®Œæ•´æ€§ä¿æŠ¤

**æµ‹è¯•å†…å®¹**ï¼š
- `CODEX_SANDBOX_*` å˜é‡ä¿æŠ¤
- ç¯å¢ƒéš”ç¦»å®Œæ•´æ€§
- æ¢å¤æœºåˆ¶éªŒè¯
- ç­–ç•¥ä¸€è‡´æ€§æ£€æŸ¥

**æˆåŠŸæ ‡å‡†**ï¼š
- å…³é”®æ²™ç®±å˜é‡å—åˆ°ä¿æŠ¤
- æ— éš”ç¦»ç ´å
- ç¯å¢ƒæ¢å¤æœºåˆ¶æ­£å¸¸

### 4. TUI å’Œ Web åŒæ—¶è¿è¡Œäº’ä¸å¹²æ‰°

**æµ‹è¯•å†…å®¹**ï¼š
- å¹¶å‘å¯åŠ¨å…¼å®¹æ€§
- èµ„æºå†²çªæ£€æµ‹ï¼ˆç«¯å£ã€æ–‡ä»¶é”ï¼‰
- æ€§èƒ½å½±å“è¯„ä¼°
- æ¸…ç†å’Œå…³é—­æœºåˆ¶

**æˆåŠŸæ ‡å‡†**ï¼š
- å¯ä»¥åŒæ—¶è¿è¡Œ
- æ— èµ„æºå†²çª
- æ€§èƒ½é™çº§ < 25%
- æ¸…ç†æœºåˆ¶å®Œå–„

## é‡åŒ–æˆåŠŸæ ‡å‡†

### å…³é”®æ€§èƒ½æŒ‡æ ‡ (KPIs)

| æŒ‡æ ‡ | ç›®æ ‡å€¼ | æƒé‡ | è¯´æ˜ |
|------|--------|------|------|
| ConversationManager çº¿ç¨‹å®‰å…¨ | 100% é€šè¿‡ | âš ï¸  é«˜ | å¿…é¡»é€šè¿‡ï¼Œå¦åˆ™å­˜åœ¨æ•°æ®ç«äº‰é£é™© |
| é…ç½®éš”ç¦»æœ‰æ•ˆæ€§ | 100% é€šè¿‡ | âš ï¸  é«˜ | å¿…é¡»é€šè¿‡ï¼Œå¦åˆ™é…ç½®å†²çª |
| æ²™ç®±å˜é‡ä¿æŠ¤ | 100% é€šè¿‡ | ğŸ”´ å…³é”® | å¿…é¡»é€šè¿‡ï¼Œå¦åˆ™å®‰å…¨æ¼æ´ |
| å¹¶å‘è¿è¡Œå…¼å®¹æ€§ | 95% é€šè¿‡ | âš ï¸  é«˜ | å…è®¸å°‘é‡éå…³é”®åŠŸèƒ½å†²çª |
| å†…å­˜ä½¿ç”¨å¢é•¿ | < 50% | ğŸ“Š ä¸­ | æ§åˆ¶èµ„æºæ¶ˆè€— |
| æ€§èƒ½é™çº§ | < 25% | ğŸ“Š ä¸­ | ä¿è¯ç”¨æˆ·ä½“éªŒ |
| å¯åŠ¨æ—¶é—´å¢é•¿ | < 100% | ğŸ“Š ä½ | å½±å“ç”¨æˆ·ä½“éªŒä½†éå…³é”® |

### é£é™©ç­‰çº§å®šä¹‰

- **ğŸŸ¢ ä½é£é™©** (0-2 åˆ†): å¯ä»¥ç›´æ¥è¿›ç¨‹å†…é›†æˆ
- **ğŸŸ¡ ä¸­é£é™©** (3-6 åˆ†): éœ€è¦é¢å¤–éš”ç¦»æœºåˆ¶
- **ğŸŸ  é«˜é£é™©** (7-10 åˆ†): å»ºè®®æ··åˆæ¨¡å¼æˆ–ç‹¬ç«‹è¿›ç¨‹
- **ğŸ”´ å…³é”®é£é™©** (11+ åˆ†): ä¸å»ºè®®é›†æˆï¼Œéœ€é‡æ–°è®¾è®¡

### é›†æˆç­–ç•¥å†³ç­–çŸ©é˜µ

| é£é™©ç­‰çº§ | é€šè¿‡ç‡ | æ¨èç­–ç•¥ |
|----------|--------|----------|
| ğŸŸ¢ ä½ | â‰¥90% | ç›´æ¥è¿›ç¨‹å†…é›†æˆ |
| ğŸŸ¡ ä¸­ | â‰¥75% | è¿›ç¨‹å†… + éš”ç¦»æœºåˆ¶ |
| ğŸŸ  é«˜ | â‰¥60% | æ··åˆæ¨¡å¼ |
| ğŸ”´ å…³é”® | <60% | ç‹¬ç«‹è¿›ç¨‹é€šä¿¡ |
| ğŸš« ä¸å¯è¡Œ | <40% | ä¸å»ºè®®é›†æˆ |

## ç›‘æ§ç­–ç•¥

### å®æ—¶ç›‘æ§ç‚¹

1. **å†…å­˜ä½¿ç”¨ç›‘æ§**
   ```rust
   // ç›‘æ§è¿›ç¨‹å†…å­˜ä½¿ç”¨å˜åŒ–
   let memory_usage = get_process_memory_usage();
   assert!(memory_usage.rss < baseline * 1.5);
   ```

2. **æ–‡ä»¶è®¿é—®å†²çªæ£€æµ‹**
   ```rust
   // æ£€æµ‹é…ç½®æ–‡ä»¶å¹¶å‘è®¿é—®
   let lock_result = try_acquire_file_lock(&config_file);
   assert!(lock_result.is_ok(), "é…ç½®æ–‡ä»¶é”å†²çª");
   ```

3. **ç¯å¢ƒå˜é‡å®Œæ•´æ€§æ£€æŸ¥**
   ```rust
   // éªŒè¯å…³é”®ç¯å¢ƒå˜é‡æœªè¢«ä¿®æ”¹
   let sandbox_var = env::var("CODEX_SANDBOX");
   assert_eq!(sandbox_var, expected_value);
   ```

### æŒç»­éªŒè¯æœºåˆ¶

```bash
# é›†æˆåˆ° CI/CD ä¸­
#!/bin/bash
cd codex-rs/integration-test

# è¿è¡ŒéªŒè¯
if cargo run --bin run-integration-test; then
    echo "âœ… é›†æˆéªŒè¯é€šè¿‡ï¼Œå¯ä»¥ç»§ç»­éƒ¨ç½²"
    exit 0
else
    echo "âŒ é›†æˆéªŒè¯å¤±è´¥ï¼Œé˜»æ­¢éƒ¨ç½²"
    exit 1
fi
```

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æµ‹è¯•å¤±è´¥: "ConversationManager çº¿ç¨‹å®‰å…¨æ€§éªŒè¯å¤±è´¥"**
   - æ£€æŸ¥æ˜¯å¦æœ‰å…¨å±€çŠ¶æ€ç«äº‰
   - éªŒè¯é”æœºåˆ¶æ˜¯å¦æ­£ç¡®å®ç°
   - æŸ¥çœ‹æ˜¯å¦æœ‰æœªå¤„ç†çš„å¼‚æ­¥æ“ä½œ

2. **æµ‹è¯•å¤±è´¥: "æ²™ç®±ç¯å¢ƒå˜é‡ä¿æŠ¤å¤±æ•ˆ"**
   - ç¡®è®¤ç¯å¢ƒå˜é‡æ¢å¤æœºåˆ¶
   - æ£€æŸ¥æ˜¯å¦æœ‰æ„å¤–çš„ç¯å¢ƒå˜é‡ä¿®æ”¹
   - éªŒè¯æ²™ç®±ç­–ç•¥é…ç½®

3. **æ€§èƒ½é™çº§è¿‡å¤§**
   - æ£€æŸ¥æ˜¯å¦æœ‰ä¸å¿…è¦çš„èµ„æºåˆ†é…
   - ä¼˜åŒ–å¹¶å‘æ“ä½œçš„æ•ˆç‡
   - è€ƒè™‘å»¶è¿Ÿåˆå§‹åŒ–ç­–ç•¥

### è°ƒè¯•å»ºè®®

```bash
# å¯ç”¨è¯¦ç»†è°ƒè¯•è¾“å‡º
RUST_LOG=debug cargo test -- --nocapture

# è¿è¡Œå•ç‹¬çš„æµ‹è¯•ç»„ä»¶
cargo test test_conversation_manager_integration
cargo test test_config_isolation_comprehensive
cargo test test_sandbox_environment_protection
cargo test test_concurrent_operation_compatibility

# ç”Ÿæˆæµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š
cargo tarpaulin --out Html
```

## å®éªŒä»·å€¼

### 1. æŠ€æœ¯é£é™©è¯„ä¼°
é‡åŒ–ä¸åŒé›†æˆæ–¹æ¡ˆçš„æŠ€æœ¯é£é™©ï¼Œä¸ºæ¶æ„å†³ç­–æä¾›æ•°æ®æ”¯æŒã€‚

### 2. æ€§èƒ½åŸºçº¿å»ºç«‹
ä¸ºåç»­çš„æ€§èƒ½ä¼˜åŒ–å’Œç›‘æ§å»ºç«‹åŸºçº¿æ•°æ®ã€‚

### 3. é›†æˆç­–ç•¥éªŒè¯
éªŒè¯ä¸åŒé›†æˆç­–ç•¥çš„å¯è¡Œæ€§å’Œæ•ˆæœã€‚

### 4. æŒç»­é›†æˆä¿éšœ
æä¾›è‡ªåŠ¨åŒ–çš„é›†æˆå…¼å®¹æ€§æ£€æŸ¥æœºåˆ¶ã€‚

## æ‰©å±•å’Œå®šåˆ¶

### æ·»åŠ æ–°çš„æµ‹è¯•åœºæ™¯

```rust
// åœ¨ lib.rs ä¸­æ·»åŠ æ–°çš„æµ‹è¯•æ–¹æ³•
impl IntegrationCompatibilityValidator {
    async fn test_custom_scenario(&self) -> Result<CustomTestResult, Box<dyn std::error::Error>> {
        // å®ç°è‡ªå®šä¹‰æµ‹è¯•é€»è¾‘
        todo!()
    }
}
```

### è°ƒæ•´æˆåŠŸæ ‡å‡†

ä¿®æ”¹ `generate_overall_assessment` æ–¹æ³•ä¸­çš„è¯„åˆ†é€»è¾‘ï¼š

```rust
// è‡ªå®šä¹‰é£é™©è¯„åˆ†æƒé‡
let mut risk_score = 0;
if !conv.thread_safety_verified {
    risk_score += 5; // è°ƒæ•´æƒé‡
}
```

### é›†æˆåˆ°ç°æœ‰å·¥ä½œæµ

```yaml
# GitHub Actions ç¤ºä¾‹
name: Integration Compatibility Test
on: [push, pull_request]

jobs:
  integration-test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Run Integration Test
        run: |
          cd codex-rs/integration-test
          cargo run --bin run-integration-test
      - name: Upload Test Report
        uses: actions/upload-artifact@v2
        with:
          name: integration-report
          path: integration_validation_report.*
```

---

è¿™ä¸ªæœ€å°éªŒè¯å®éªŒèƒ½å¤Ÿåœ¨æœ€çŸ­æ—¶é—´å†…ä¸º Codex Web é¡¹ç›®çš„é›†æˆå†³ç­–æä¾›å¯é çš„æ•°æ®æ”¯æŒï¼Œç¡®ä¿åœ¨ä¸ç ´åç°æœ‰ç³»ç»Ÿçš„å‰æä¸‹å®ç° Web ç«¯åŠŸèƒ½ã€‚