# TUI Esc 双击清空与历史回退

Esc 键现在根据输入框状态呈现两段式行为：

## 行为速览
- **输入框非空**：
  - 第一次 Esc 仅高亮底栏的 `Esc clear` 提示。
  - 一秒内再次按 Esc 才会清空文本；逾期提示自动消失。
- **输入框为空**：
  - 第一次 Esc 进入“预备态”，底栏提示即将回退。
  - 再按 Esc 打开“Backtrack to User Messages” 列表，可选择历史用户消息分叉重新编辑。
- Transcript overlay（`Ctrl+T`）依旧支持 Esc/Enter 步进，便于在历史视图里快速定位。

## 使用技巧
- 清空提示出现时，任意输入或切换面板会自动取消提示，避免误删。
- 历史列表打开后，可用 `↑/↓` 选择节点，`Enter` 回退并回填文本，`Esc` 取消。
- 配合 ModeBar，可先回退到历史节点，再编辑模式变量形成新的回合。

## 场景示例
1. 编写草稿时掏出 Esc：若要快速清空，Esc 两次；若只是误触，不再按即可保留。
2. 想回到更早的指令：在空输入框连按两次 Esc，选择目标消息后直接继续对话。
3. 调试多轮上下文：结合 `Ctrl+T` 的转录视图，Esc 在 overlay 中会逐步向更早的用户消息移动。

想了解背后的状态机与 UI 防御细节，请参阅 `docs/feats/design/tui-esc.md`。
